/*!
 * CookieStorage
 * -------------
 * Use cookie as object storage
 *
 * @version 0.1.1
 * @author mach3 <http://github.com/mach3>
 * @license MIT License
 * @url http://github.com/mach3/cookie-storage.js
 */
 !function(a,b){var c,d;c={type:function(a){var b=Object.prototype.toString.call(a).match(/\[object\s(\w+?)\]/);return b?b[1].toLowerCase():null},extend:function(a,b){return c.each(b,function(b,c){a[c]=b}),a},each:function(a,b){var c;if("array"===this.type(a))for(c=0;c<a.length&&!1!==b(a[c],c,a);c++);else for(c in a)if(a.hasOwnProperty(c)&&!1===b(a[c],c,a))break;return a},parseCookie:function(a){var b={};return this.each(a.split(/\s*;\s*/),function(a){var c=a.match(/^(.+?)=(.+)$/);c&&(b[c[1]]=c[2])}),b},delayDate:function(a,b){return a.setTime(a.getTime()+1e3*b),a},diffTime:function(a,b){return parseInt((a.getTime()-b.getTime())/1e3,10)}},d=function(){this.init.apply(this,arguments)},function(){this.defaults={path:null,domain:null,lifetime:null,secure:!1},this.name=null,this.options=null,this.data=null,this.init=function(a,b){if("string"!==c.type(a))throw new Error("Invalid storage name.");this.name=a,this.options={},this.config({}).config(this.defaults),"object"===c.type(b)&&this.config(b),this.fetch()},this.config=function(){var a=Array.prototype.slice.call(arguments);switch(!0){case"undefined"===c.type(a[0]):return this.options;case"string"===c.type(a[0])&&a.length>1:return this.options[a[0]]=a[1],this;case"string"===c.type(a[0])&&1===a.length:return this.options[a[0]];case"object"===c.type(a[0]):return c.extend(this.options,a[0]),this;default:return this}},this.fetch=function(){var a,b;return a=c.parseCookie(document.cookie),b=encodeURIComponent(this.name),this.data=b in a?JSON.parse(decodeURIComponent(a[b])):{},this},this.set=function(a,b){var d=this;return"object"===c.type(a)?(c.each(a,function(a,b){d.set(b,a)}),this):(this.data[a]=b,this)},this.get=function(a){return void 0===a?this.data:this.data[a]},this.remove=function(a){var b={};return a&&(c.each(this.data,function(c,d){d!==a&&(b[d]=c)}),this.data=b),this},this.save=function(){var a=encodeURIComponent(this.name)+"="+encodeURIComponent(JSON.stringify(this.data))+";"+this.getSuffix();return b.cookie=a,this},this.getSuffix=function(){var a,b=this;return a=[],c.each(["path","domain"],function(c){b.config(c);b.config(c)&&a.push(c+"="+b.config(c))}),function(b){var d,e=new Date;if(null!==b){if(1/0===b)return d=new Date("2038/1/8 00:00:00"),a.push("max-age="+c.diffTime(d,e)),void a.push("expires="+d.toUTCString());a.push("max-age="+b),a.push("expires="+c.delayDate(e,b).toUTCString())}}(this.config("lifetime")),this.config("secure")&&a.push("secure"),a.join(";")},this.clear=function(a){return this.data={},a?this.save():this}}.call(d.prototype),function(){var b=a.CookieStorage;a.CookieStorage=d,a.CookieStorage.noConflict=function(){return a.CookieStorage=b,d}}()}(window,document);